# 网页抓取分析服务系列之五（并发控制）

## 任务目的
* 任务的并行控制逻辑设计
* socket.io的使用

## 任务描述
* 在4的基础上前端增加一个输入选项（页码），表面需要抓取的页数，另外设备输入值由下拉框改为多选框。
* 单个用户可以选择多个设备的模拟任务，并且每个设备需要抓取多页。
* 服务器端根据选择的情况，生成任务待执行队列，每个phantomjs任务只执行一次抓取。同时允许nodejs调起最大5个phantomjs的进程。
* 前后端改为通过web socket通信，使用socket.io库，每完成一个抓取，将结果追加到页面中。同时在页面的最上方显示当前的进度（完成数/总任务数）。

## 任务注意事项
* phantomjs进程的最大5个并发需要考虑多人同时提交和任务积压的情况：即两个用户A、B同时提交了4个任务到服务端，服务端只能执行A的4个、和B的1个，等前面有执行完毕的，B的剩下的再执行。

## 参考资料
* [socket.io参考](https://cnodejs.org/topic/50a1fcc7637ffa4155b5a264)